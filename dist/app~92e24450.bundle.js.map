{"version":3,"file":"app~92e24450.bundle.js","mappings":";0YACA,gnGAAAA,GAAA,wBAAAA,EAAA,sBAAAA,GAAA,iBAAAA,GAAA,ssDAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,4bAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,yhBAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,qGAAAA,EAAA,yBAAAA,GAAA,IAAAA,EAAA,uBAAAA,GAAA,kkBAiDA,QA5C4B,CACpBC,KAAI,YAAsC,oHAEhB,OAFnBC,EAAmB,EAAnBA,oBAAqBC,EAAU,EAAVA,WAChC,EAAKC,qBAAuBF,EAC5B,EAAKG,YAAcF,EAAW,SAExB,EAAKG,gBAAe,0CAJoB,EAKhD,EAEMA,cAAa,WAAG,kHACV,OAAFC,EAAO,EAAKF,YAAZE,GAAE,SAEA,EAAKC,mBAAmBD,GAAG,kCACnC,EAAKE,eAAe,sBAEpB,EAAKC,cAAc,0CAND,EAQtB,EAEMF,mBAAkB,SAACD,GAAI,uHACFI,EAAAA,EAAAA,cAAiCJ,GAAG,OAA7C,OAAVJ,EAAa,EAAH,yBACPA,GAAU,0CAFQ,EAG7B,EAEAO,YAAW,WAAG,WACZE,KAAKR,qBAAqBS,WAAYC,EAAAA,EAAAA,MAEnBC,SAASC,cAAc,eAC/BC,iBAAiB,QAAO,YAAE,8FAC7BN,EAAAA,EAAAA,cAAiC,EAAKN,aAAY,OACxD,EAAKC,gBAAgB,2CAEzB,EAEAG,aAAY,WAAG,WACbG,KAAKR,qBAAqBS,WAAYK,EAAAA,EAAAA,MAEnBH,SAASC,cAAc,eAC/BC,iBAAiB,QAAO,YAAE,8FAC7BN,EAAAA,EAAAA,iBAAoC,EAAKN,YAAYE,IAAG,OAC9D,EAAKD,gBAAgB,2CAEzB,qQC9CF,qwNAyCA,QA1C2B,CACzBa,iBAAgB,YAAqB,IAAlBC,EAAK,EAALA,MAAOC,EAAO,EAAPA,QACxB,GAAKT,KAAKU,qBAKV,OAAKV,KAAKW,wBAMVX,KAAKY,kBAAkB,CAAEJ,MAAAA,EAAOC,QAAAA,KAL9BI,QAAQC,IAAI,4CACZd,KAAKe,sBANLF,QAAQC,IAAI,6CAWhB,EAEAJ,mBAAkB,WAChB,MAAO,iBAAkBM,MAC3B,EAEAL,iBAAgB,WACd,MAAmC,YAA5BM,aAAaC,UACtB,EAEMH,mBAAkB,WAAG,uHACJE,aAAaE,oBAAmB,OAEtC,YAFTC,EAAS,EAAH,OAGVP,QAAQC,IAAI,uBAGC,YAAXM,GACFP,QAAQC,IAAI,qBACb,0CATwB,EAU3B,EAEMF,kBAAiB,YAAqB,yGAAJ,OAAdJ,EAAK,EAALA,MAAOC,EAAO,EAAPA,QAAO,SACEY,UAAUC,cAAcC,MAAK,OAAnC,EAAH,KACLC,iBAAiBhB,EAAOC,GAAS,0CAFjB,EAG5C,mSCtCF,ijNAgBA,QAfgB,eADhB,EACgB,GADhB,EACgB,UAAG,uFACX,kBAAmBY,UAAS,gBAC2B,OAA3DR,QAAQC,IAAI,+CAA+C,0BAIR,OAA/CW,EAAK,IAAIC,EAAAA,GAAsB,iBAAgB,kBAE7CD,EAAGE,WAAU,OACnBd,QAAQC,IAAI,6BAA6B,kDAEzCD,QAAQC,IAAI,oCAAqC,EAAF,IAAS,yDAZ5D,+KAcC,kBAbe,yFCmBhB,QAlB2B,CACzBzB,KAAI,SAACuC,GACe,IAAIC,UAAUD,GACtBE,UAAY9B,KAAK+B,iBAC7B,EAEAA,kBAAiB,SAACC,GAChB,IAAMzC,EAAa0C,KAAKC,MAAMF,EAAQG,MACtCC,EAAAA,EAAAA,iBAAoC,CAClC5B,MAAO,OACPC,QAAS,CACP4B,KAAM,OACNC,MAAO,GAAF,OAAKC,EAAAA,EAAAA,eAAwBhD,EAAWiD,aAGnD","sources":["webpack://movie-catalogue/./src/scripts/utils/like-button-initiator.js","webpack://movie-catalogue/./src/scripts/utils/notification-helper.js","webpack://movie-catalogue/./src/scripts/utils/sw-register.js","webpack://movie-catalogue/./src/scripts/utils/websocket-initiator.js"],"sourcesContent":["import FavoriteRestaurant from '../data/favorite-restaurant';\r\nimport {\r\n  createLikeButtonTemplate,\r\n  createLikedButtonTemplate,\r\n} from '../views/templates/template-creator';\r\n\r\nconst LikeButtonInitiator = {\r\n  async init({ likeButtonContainer, restaurant }) {\r\n    this._likeButtonContainer = likeButtonContainer;\r\n    this._restaurant = restaurant;\r\n\r\n    await this._renderButton();\r\n  },\r\n\r\n  async _renderButton() {\r\n    const { id } = this._restaurant;\r\n\r\n    if (await this._isRestaurantExist(id)) {\r\n      this._renderLiked();\r\n    } else {\r\n      this._renderLike();\r\n    }\r\n  },\r\n\r\n  async _isRestaurantExist(id) {\r\n    const restaurant = await FavoriteRestaurant.getRestaurant(id);\r\n    return !!restaurant;\r\n  },\r\n\r\n  _renderLike() {\r\n    this._likeButtonContainer.innerHTML = createLikeButtonTemplate();\r\n\r\n    const likeButton = document.querySelector('#likeButton');\r\n    likeButton.addEventListener('click', async () => {\r\n      await FavoriteRestaurant.putRestaurant(this._restaurant);\r\n      this._renderButton();\r\n    });\r\n  },\r\n\r\n  _renderLiked() {\r\n    this._likeButtonContainer.innerHTML = createLikedButtonTemplate();\r\n\r\n    const likeButton = document.querySelector('#likeButton');\r\n    likeButton.addEventListener('click', async () => {\r\n      await FavoriteRestaurant.deleteRestaurant(this._restaurant.id);\r\n      this._renderButton();\r\n    });\r\n  },\r\n};\r\n\r\nexport default LikeButtonInitiator;\r\n","const NotificationHelper = {\r\n  sendNotification({ title, options }) {\r\n    if (!this._checkAvailability()) {\r\n      console.log('Notification not supported in this browser');\r\n      return;\r\n    }\r\n\r\n    if (!this._checkPermission()) {\r\n      console.log('User did not yet granted permission');\r\n      this._requestPermission();\r\n      return;\r\n    }\r\n\r\n    this._showNotification({ title, options });\r\n  },\r\n\r\n  _checkAvailability() {\r\n    return 'Notification' in window;\r\n  },\r\n\r\n  _checkPermission() {\r\n    return Notification.permission === 'granted';\r\n  },\r\n\r\n  async _requestPermission() {\r\n    const status = await Notification.requestPermission();\r\n\r\n    if (status === 'denied') {\r\n      console.log('Notification Denied');\r\n    }\r\n\r\n    if (status === 'default') {\r\n      console.log('Permission closed');\r\n    }\r\n  },\r\n\r\n  async _showNotification({ title, options }) {\r\n    const serviceWorkerRegistration = await navigator.serviceWorker.ready;\r\n    serviceWorkerRegistration.showNotification(title, options);\r\n  },\r\n};\r\n\r\nexport default NotificationHelper;\r\n","import * as WorkboxWindow from 'workbox-window';\r\n\r\nconst swRegister = async () => {\r\n  if (!('serviceWorker' in navigator)) {\r\n    console.log('Service Worker not supported in the browser');\r\n    return;\r\n  }\r\n\r\n  const wb = new WorkboxWindow.Workbox('/sw.bundle.js');\r\n  try {\r\n    await wb.register();\r\n    console.log('Service worker registered');\r\n  } catch (error) {\r\n    console.log('Failed to register service worker', error);\r\n  }\r\n};\r\n\r\nexport default swRegister;\r\n","import NotificationHelper from './notification-helper';\r\nimport CONFIG from '../globals/config';\r\n\r\nconst WebSocketInitiator = {\r\n  init(url) {\r\n    const webSocket = new WebSocket(url);\r\n    webSocket.onmessage = this._onMessageHandler;\r\n  },\r\n\r\n  _onMessageHandler(message) {\r\n    const restaurant = JSON.parse(message.data);\r\n    NotificationHelper.sendNotification({\r\n      title: 'test',\r\n      options: {\r\n        body: 'test',\r\n        image: `${CONFIG.BASE_IMAGE_URL + restaurant.pictureId}`,\r\n      },\r\n    });\r\n  },\r\n};\r\n\r\nexport default WebSocketInitiator;\r\n"],"names":["i","init","likeButtonContainer","restaurant","_likeButtonContainer","_restaurant","_renderButton","id","_isRestaurantExist","_renderLiked","_renderLike","FavoriteRestaurant","this","innerHTML","createLikeButtonTemplate","document","querySelector","addEventListener","createLikedButtonTemplate","sendNotification","title","options","_checkAvailability","_checkPermission","_showNotification","console","log","_requestPermission","window","Notification","permission","requestPermission","status","navigator","serviceWorker","ready","showNotification","wb","WorkboxWindow","register","url","WebSocket","onmessage","_onMessageHandler","message","JSON","parse","data","NotificationHelper","body","image","CONFIG","pictureId"],"sourceRoot":""}